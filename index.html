<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
        body {
	margin: 0;
	padding: 0;
	font-size: 18px;
    font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
	color: var(--tg-theme-text-color);
	background: var(--tg-theme-bg-color);
}
    </style>
	<title>v0.0.4</title>
</head>
<body>
    <p>Здравствуйте, <span id="firstName">%%%</span></p>
    <p>ID: <span id="uid">%%%</span></p>
    <p>Ваш баланс: <span id="bal">%%%</span></p>
    <button id="click" onclick="addbal(1);">click me</button>

	<script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
function addbal(abal) {
    fetch(`http://178.253.40.67:8012/${tg.initDataUnsafe.user.id}/${abal}/`).then(function(response) {
      document.getElementById('bal').innerText = response.text;
    }).catch(function(err) {
      console.log('Fetch Error :-S', err);
    });
}
addbal(0);

let tg = window.Telegram.WebApp;
tg.expand();
tg.MainButton.setText("Выйти");
tg.MainButton.textColor = '#FFFFFF';
tg.MainButton.color = '#2cab37';
tg.MainButton.show();

let bal = 0;

Telegram.WebApp.onEvent("mainButtonClicked", function(){
	tg.sendData(`${bal}`);
});

document.getElementById('firstName').innerText = tg.initDataUnsafe.user.first_name;
document.getElementById('uid').innerText = tg.initDataUnsafe.user.id;
// tg.initDataUnsafe.user.id

</script>
</body>
</html>
